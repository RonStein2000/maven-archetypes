<archetype-descriptor
  xmlns="http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/plugins/maven-archetype-plugin/archetype-descriptor/1.0.0 http://maven.apache.org/xsd/archetype-descriptor-1.0.0.xsd"
  name="eosgi-module-archetype">
  
  <fileSets>

    <fileSet filtered="true" packaged="true">
      <directory>src/main/java</directory>
      <includes>
        <include>**/*.java</include>
      </includes>
    </fileSet>

    <fileSet filtered="true" packaged="true">
      <directory>src/test/java</directory>
      <includes>
        <include>**/*.java</include>
      </includes>
    </fileSet>

    <fileSet filtered="true" packaged="false">
      <directory/>
      <includes>
        <include>launch.bndrun</include>
        <include>.gitignore</include>
      </includes>
    </fileSet>
  </fileSets>

  <requiredProperties>
    <requiredProperty key="distro_version">
      <defaultValue>##
## Force mvn to pass this whole block through to Velocity --> ${} ##
## Bootstrap some types and methods we need to use...##
#set($String='')##
#set($System=$String.class.forName('java.lang.System'))##
#set($File=$String.class.forName('java.io.File'))##
#set($NewFile=$File.getConstructor($String.class))##
#set($NewFileReader=$String.class.forName('java.io.FileReader').getConstructor($File))##
#set($NewMavenXpp3Reader=$String.class.forName('org.apache.maven.model.io.xpp3.MavenXpp3Reader').getConstructor())##
#set($errorResult='omit_distro')##
##
#set($cwd=$System.getProperty('user.dir'))##
#set($distroPomPath=$cwd + "/_distro/pom.xml")##
#set($distroPomFile=$NewFile.newInstance($distroPomPath))##
#if($distroPomFile.exists())##
#set($pomFileReader=$NewFileReader.newInstance($distroPomFile))##
#set($pomReader=$NewMavenXpp3Reader.newInstance())##
#set($distroPom=$pomReader.read($pomFileReader))##
#set($distroVersion=$distroPom.getVersion())##
##
#if($distroVersion)##
$distroVersion##
#else ## null version in distro -> load from parent
#set($parentPom=$distroPom.getParent())##
#if($parentPom)##
$parentPom.getVersion()##
#else ## null parent
$errorResult##
#end##
#end##
#else ## distro file does not exist
$errorResult##
#end
## If you see this message, something went wrong!</defaultValue>
    </requiredProperty>
  </requiredProperties>

</archetype-descriptor>
